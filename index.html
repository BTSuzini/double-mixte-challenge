<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suzini BT â€” Double Mixte Challenge</title>
  <link rel="stylesheet" href="assets/css/main.css?v=20260221" />
</head>
<body>

<header class="topbar">
  <div class="container">
    <div class="topbar-row topbar-row-general">
      <div class="brand-logo">
        <img src="assets/img/logo-suzini.png" alt="Logo Suzini">
      </div>

      <!-- âœ… Image au centre (remplace le texte) -->
      <div class="general-title-wrap" aria-label="Suzini BT â€” Double Mixte Challenge">
        <img class="general-title-img" src="assets/img/challenge-gen.png" alt="Suzini BT â€” Double Mixte Challenge">
      </div>

      <div class="brand-logo">
        <img src="assets/img/logo-challenge.png" alt="Logo Challenge">
      </div>
    </div>

    <nav class="nav nav-general">
      <!-- 1) Accueil : emoji seul -->
      <a href="index.html" aria-current="page" title="Accueil" aria-label="Accueil">ğŸ </a>

      <!-- 2) RÃ¨glement -->
      <a href="pages/reglement.html">ğŸ“˜ RÃ¨glement</a>

      <!-- 3) Classement -->
      <a href="pages/classement.html">ğŸ† Classement</a>

      <!-- 4) Boutique -->
      <a href="pages/boutique.html">ğŸ›ï¸ Boutique</a>

      <!-- 5) Infos -->
      <a href="pages/infos.html">ğŸ“° Infos</a>

      <!-- 6) Contact -->
      <a href="pages/contact.html" title="Contact" aria-label="Contact">ğŸ“© ğŸ“</a>
    </nav>
  </div>
</header>
  
<main class="container">

  <section class="card">
    <h2>ğŸ—“ï¸ Les Ã©tapes</h2>
    <div class="grid">
      <a class="btn" href="etape1/equipes.html">ğŸ¾ Ã‰tape 1 â€” 27/02/2026 â€” BT250</a>

      <a class="btn disabled" href="#" data-disabled="true" aria-disabled="true">â³ Ã‰tape 2 â€” 12/03/2026 â€” Ã  venir</a>
      <a class="btn disabled" href="#" data-disabled="true" aria-disabled="true">â³ Ã‰tape 3 â€” 26/03/2026 â€” Ã  venir</a>
      <a class="btn disabled" href="#" data-disabled="true" aria-disabled="true">â³ Ã‰tape 4 â€” 09/04/2026 â€” Ã  venir</a>

      <a class="btn" href="etape5/equipes.html">ğŸ§ª Ã‰tape 5 â€” 17/04/2026 â€” TEST</a>
    </div>
    <p class="muted">ğŸ“Œ Le classement gÃ©nÃ©ral est calculÃ© par joueur (points + dÃ©partages).</p>
  </section>

  <section class="card">
    <h2>âš¡ AccÃ¨s rapide</h2>
    <div class="grid">
      <a class="btn" href="pages/classement.html">ğŸ† Voir le classement gÃ©nÃ©ral</a>
      <a class="btn" href="pages/reglement.html">ğŸ“˜ Lire le rÃ¨glement</a>
      <a class="btn" href="pages/infos.html">ğŸ“° Fil dâ€™infos</a>
      <a class="btn" href="pages/boutique.html">ğŸ›ï¸ Boutique / Paiement</a>
      <a class="btn" href="pages/contact.html">ğŸ“© Contact</a>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ” AccÃ¨s organisateurs</h2>

    <div class="grid">
      <a class="btn" href="#" id="btnAdmin">ğŸ› ï¸ Mode Admin</a>
      <a class="btn" href="#" id="btnJat">ğŸ¾ Mode JAT</a>
      <a class="btn" href="#" id="btnLogout">ğŸšª DÃ©connexion</a>
    </div>

    <p class="muted">AccÃ¨s sÃ©curisÃ© (email / mot de passe).</p>
    <p class="muted" id="authHint" style="margin-top:8px;"></p>
  </section>

</main>

<style>
  /* âœ… Centre image du bandeau gÃ©nÃ©ral */
  .topbar-row-general{
    grid-template-columns: var(--logo-size) 1fr var(--logo-size);
  }
  .general-title-wrap{
    display:flex;
    align-items:center;
    justify-content:center;
    min-height: calc(var(--logo-size) * 0.55);
    overflow:hidden;
  }
  .general-title-img{
    width: min(560px, 100%);
    max-height: 88px;
    height: auto;
    object-fit: contain;
    display:block;
    filter: drop-shadow(0 1px 0 rgba(0,0,0,.15));
  }

  /* âœ… Nav gÃ©nÃ©ral : 2 lignes + justifiÃ© (gauche/droite) */
  .nav-general{
    justify-content: space-between;
    gap: 8px;
  }
  .nav-general::after{
    content:"";
    flex:auto; /* aide Ã  â€œÃ©talerâ€ sur 2 lignes */
  }
  .nav-general a{
    padding:8px 12px;
    flex: 1 1 auto;
    text-align:center;
  }

  /* âœ… Lien actif plus visible */
  .nav a[aria-current="page"]{
    background: rgba(255,255,255,.26);
    border-color: rgba(255,255,255,.45);
    box-shadow: 0 6px 14px rgba(0,0,0,.10);
  }

  @media (max-width: 420px){
    .nav-general a{
      padding:7px 10px;
      font-size: 13px;
    }
    .general-title-img{ max-height: 74px; }
  }
</style>

<script type="module">
  import { auth } from "./assets/js/firebase.js";
  import { autoLoginOrPrompt, logout, ensurePersistence } from "./assets/js/session.js";
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

  // âœ… persistance (reste connectÃ© sur le mÃªme appareil)
  await ensurePersistence();

  // âœ… neutralise les liens disabled proprement
  document.querySelectorAll("a[data-disabled='true']").forEach(a=>{
    a.addEventListener("click", (e)=>{
      e.preventDefault();
    });
  });

  async function goToRoleHome(roleHomePath){
    // Si dÃ©jÃ  connectÃ© => redirige direct. Sinon => prompt login.
    await autoLoginOrPrompt("general");
    // si login ok (ou dÃ©jÃ  connectÃ©) -> on navigue
    window.location.href = roleHomePath;
  }

  document.getElementById("btnAdmin").onclick = async (e)=>{
    e.preventDefault();
    await goToRoleHome("admin/index.html");
  };

  document.getElementById("btnJat").onclick = async (e)=>{
    e.preventDefault();
    await goToRoleHome("jat/index.html");
  };

  document.getElementById("btnLogout").onclick = async (e)=>{
    e.preventDefault();
    await logout();
    alert("DÃ©connectÃ© âœ…");
  };

  onAuthStateChanged(auth, (user)=>{
    document.getElementById("authHint").textContent =
      user ? ("ConnectÃ© : " + user.email) : "Non connectÃ©.";
  });
</script>

</body>
</html>
